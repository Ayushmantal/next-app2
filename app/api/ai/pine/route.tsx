import pc from "@/lib/pinecone/client";
import { NextRequest, NextResponse } from "next/server";
import fs from "fs";
import csv from "csv-parser";

interface Match {
  id: string;
  values: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1];
  metadata: { genre: "drama" };
}

interface ApiResponse {
  matches: Match[];
  namespace: string;
  usage: {
    readUnits: number;
  };
}

const filePath = process.cwd() + "/public/data/amazon.csv";

export async function POST(request: NextRequest, response: NextResponse) {
  //const currentIndex = await pc.describeIndex("food");
  /*
  {
    "indexes": [
        {// this is index description 
            "name": "sample-movies",
            "dimension": 1024,
            "metric": "cosine",
            "host": "sample-movies-4frf01c.svc.aped-4627-b74a.pinecone.io",
            "deletionProtection": "disabled",
            "spec": {
                "serverless": {
                    "cloud": "aws",
                    "region": "us-east-1"
                }
            },
            "status": {
                "ready": true,
                "state": "Ready"
            }
        }
    ]
}
*/

  //food
  const searchVector = [
    0.28, 0.02, 0.63, 0.74, 0.13, 0.48, 0.55, 0.81, 0.12, 0.37, 0.67, 0.96,
    0.59, 0.59, 0.5, 0.51, 0.21, 0.57, 0.09, 0.81, 0.77, 0.75, 0.63, 0.41, 0.91,
    0.66, 0.94, 0.5, 0.59, 0.51, 0.79, 0.06, 0.94, 0.23, 0.13, 0.95, 0.09, 0.59,
    0.77, 0.75, 0.67, 0.65, 0.5, 0.34, 0.04, 0.4, 0.83, 0.08, 0.24, 0.07, 0.38,
    0.15, 0.86, 0.2, 0.46, 0.5, 0.77, 0.67, 0.44, 0.01, 0.97, 0.52, 0.12, 0.08,
    0.56, 0.09, 0.48, 0.83, 0.48, 0.62, 0.4, 0.43, 0.14, 0.51, 0.38, 0.92, 0.96,
    0.99, 0.24, 0.78, 0.39, 0.81, 0.18, 0.87, 0.9, 0.57, 0.35, 0.89, 0.43, 0.64,
    0.77, 0.06, 0.19, 0.04, 0.13, 0.26, 0.55, 0.83, 0.19, 0.08, 0.82, 0.82,
    0.49, 0.48, 0.14, 0.75, 0.09, 0.01, 0.59, 0.4, 0.07, 0.88, 0.62, 0.86, 0.79,
    0.41, 0.34, 0.75, 0.07, 0.64, 0.62, 0.85, 0.99, 0.41, 0.96, 0.13, 0.08,
    0.34, 0.3, 0.55, 0.34, 0.66, 0.92, 0.65, 0.85, 0.87, 0.7, 0.4, 0.03, 0.78,
    0.96, 0.53, 0.16, 0.23, 0.48, 0.51, 0.59, 0.56, 0.59, 0.5, 0.72, 0.83, 0.98,
    0.06, 0.84, 0.13, 0.37, 0.25, 0.98, 0.76, 0.78, 0.66, 0.84, 0.75, 0.88,
    0.16, 0.21, 0.52, 0.87, 0.62, 0.61, 0.92, 0.8, 0.83, 0.42, 0.67, 0.77, 0.22,
    0.22, 0.24, 0.18, 0.49, 0.66, 0.16, 0.38, 0.15, 0.84, 0.3, 0.4, 0.01, 0.63,
    0.94, 0.01, 0.71, 0.36, 0.74, 0.44, 0.23, 0.49, 0.36, 0.14, 0, 0.54, 0.23,
    0.22, 0.93, 0.44, 0.43, 0.77, 0.56, 0.75, 0.73, 0.4, 0.97, 0.64, 0.77, 0.96,
    0.54, 0.67, 0.29, 0.35, 0.6, 0.85, 0.06, 0.98, 0.95, 0.2, 0.84, 0.8, 0.62,
    0.14, 0.96, 0.25, 0.56, 0.55, 0.9, 0.86, 0.72, 0.32, 0.74, 0.57, 0.31, 0.4,
    0.71, 0.58, 0.19, 0.57, 0.65, 0.97, 0.48, 0.94, 0.48, 0.72, 0.55, 0.88,
    0.76, 0.06, 0.66, 0.37, 0.22, 0.13, 0.01, 0.96, 0.5, 0.19, 0.69, 0.79, 0.92,
    0.93, 0.7, 0.7, 0.08, 0.14, 0.51, 0.19, 0.39, 0.41, 0.36, 0.81, 0.15, 0.74,
    0.28, 0.07, 0.59, 0.95, 0.99, 0.51, 0.16, 0.28, 0.37, 0.96, 0.94, 0.94,
    0.22, 0.28, 0.21, 0.42, 0.21, 0.68, 0.12, 0.7, 0.53, 0.2, 0.39, 0.67, 0.03,
    0.52, 0.72, 0.76, 0.98, 0.66, 0.98, 0.34, 0.33, 0.32, 0.45, 0.89, 0.53,
    0.68, 0.21, 0.53, 0.85, 0.63, 0.9, 0.21, 0.76, 0.61, 0.98, 0.03, 0.89, 0.13,
    0.34, 0.62, 0.64, 0.04, 0.05, 0.91, 0.84, 0.71, 0.89, 0.08, 0.01, 0.8, 0.22,
    0.48, 0.36, 0.32, 0.46, 0.01, 0.31, 0.16, 0.77, 0.32, 0.02, 0.35, 0.13,
    0.03, 0.81, 0.49, 0.81, 0.16, 0.67, 0.22, 0.2, 0.97, 0.78, 0.43, 0.74, 0.05,
    0.76, 0.53, 0.42, 0.57, 0.36, 0.93, 0.65, 1, 0.31, 0.69, 0.93, 0.17, 0.38,
    0.72, 0.83, 0.79, 0.52, 0.77, 0.38, 0.84, 0.64, 0.67, 0.07, 0.38, 0.1, 0.19,
    0.57, 0.58, 0.73, 0.51, 0.19, 0.77, 0.54, 0.48, 0.39, 0.63, 0.79, 0.14,
    0.17, 0.35, 0.86, 0.3, 0.98, 0.13, 0.38, 0.14, 0.03, 0.68, 0.8, 0.3, 0.81,
    0.95, 0.63, 0.64, 0.86, 0.52, 0.37, 0.52, 0.53, 0.86, 0.14, 0.23, 0.88,
    0.49, 0.63, 0.16, 0.84, 0.19, 0.65, 0.45, 0.63, 0.68, 0.25, 0.92, 0.28,
    0.96, 0.7, 0.57, 0.69, 0.67, 0.34, 0.2, 0.42, 0.02, 0.41, 0.09, 0.86, 0.5,
    0.06, 0.63, 0.15, 0.27, 0.01, 0.2, 0.43, 0.1, 0.56, 0.67, 0.88, 0.09, 0.52,
    0.46, 0.16, 0.72, 0.85, 0.05, 0.86, 0.42, 0.18, 0.91, 0.79, 0.38, 0.53,
    0.56, 0.84, 0.39, 0.8, 0.72, 0.01, 0.83, 0.69, 0.7, 0.73, 0.16, 0.71, 0.71,
    0.82, 0.03, 0.45, 0.63, 0.58, 0.7, 0.01, 0.6, 0.61, 0.92, 0.33, 0.41, 0.99,
    0.31, 0.17, 0.45, 0.11, 0.16, 0.9, 0.86, 0.02, 0.61, 0.68, 0.63, 0.05, 0.58,
    0.64, 0.19, 0.29, 0.55, 0.19, 0.22, 0.83, 0.87, 0.11, 0.74, 0.47, 0.09,
    0.23, 0.46, 0.55, 0.95, 0.42, 0.39, 0.58, 0.97, 0.72, 0.59, 0.56, 0.32, 0.2,
    0.58, 0.83, 0.97, 0.36, 0.45, 0.01, 0.18, 0.02, 0.37, 0.98, 0.82, 0.68,
    0.82, 0.27, 0.81, 0.66, 0.38, 0.67, 0.76, 0.85, 0.07, 0.91, 0.55, 0.92,
    0.28, 0.44, 0.75, 0.77, 0.84, 0.93, 0.2, 0.13, 0.3, 0.85, 0.08, 0.73, 0.66,
    0.97, 0.53, 0.26, 0.28, 0.77, 0, 0.03, 0.35, 0.52, 0.55, 0.96, 0.77, 0.89,
    0.11, 0.24, 0.96, 0.35, 0.58, 0.53, 0.32, 0.2, 0.68, 0.09, 0.29, 0.84, 0.36,
    0.75, 0.28, 0.01, 0.04, 0.79, 0.83, 0.15, 0.67, 0.6, 0.8, 0.64, 0.19, 0.28,
    0.97, 0.98, 0.42, 0.87, 0.38, 0.02, 0.39, 0.91, 0.27, 0.42, 0.45, 0.89,
    0.55, 0.18, 0.5, 0.01, 0.87, 0.67, 0.74, 0.43, 0.91, 0.25, 0.14, 0.99, 0.78,
    0.04, 0.33, 0.5, 0.89, 0.98, 0.41, 0.2, 0.34, 0.36, 0.35, 0.27, 0.48, 0.62,
    0.72, 0.42, 0.5, 0.45, 0.99, 0.88, 0.42, 0.27, 0.2, 0.39, 0.36, 0.51, 0.59,
    0.64, 0.8, 0.74, 0.64, 0.13, 0.43, 0.19, 0.22, 0.38, 0.79, 0.4, 0.75, 0.65,
    0.17, 0.85, 0.67, 0.25, 0.93, 0.25, 0.38, 0.55, 0.51, 0.07, 0.02, 0.53,
    0.56, 0.16, 0.87, 0.77, 0.83, 0.42, 0.13, 0.9, 0.2, 0.03, 0.84, 0.5, 0.34,
    0.39, 0.43, 0.85, 0.6, 0.69, 0.09, 0.85, 0.21, 0.13, 0.7, 0.57, 0.63, 0.05,
    0.03, 0.28, 0.71, 0.31, 0.18, 0.98, 0.76, 0.53, 0.68, 0.11, 0.25, 0.03,
    0.99, 0.29, 0.61, 0.91, 0.16, 0.09, 0.46, 0.83, 0.51, 0.56, 0.53, 0.62,
    0.43, 0.86, 0.67, 0.8, 0.94, 0.9, 0.11, 0.04, 0.66, 0.31, 0.11, 0.15, 0.39,
    0.12, 0.97, 0.12, 0.34, 0, 0.88, 1, 0.93, 0.07, 0.42, 0.92, 0.64, 0.99,
    0.66, 0.44, 0.33, 0.22, 0.21, 0.99, 0.15, 0.35, 0.02, 0.52, 0.65, 0.44,
    0.43, 0.69, 0.43, 0.64, 0.83, 0.07, 0.87, 0.94, 0.98, 0, 0.07, 0.23, 0.52,
    0.53, 0.77, 0.08, 0.36, 0.09, 0.9, 0.31, 0.5, 0.75, 0.69, 0.87, 0.05, 0,
    0.62, 0.84, 0.38, 0.05, 0.93, 0.8, 0.2, 0.76, 0.97, 0.96, 0.23, 0.37, 0.91,
    0.81, 0.77, 0.94, 0.48, 0.23, 0.68, 0.09, 0.06, 0.13, 0.3, 0.21, 0.84, 0.51,
    0.45, 0.68, 0.71, 0.26, 0.9, 0.24, 0.91, 0.54, 0.53, 0.25, 0.71, 0.3, 0.82,
    0.38, 0.65, 0.55, 1, 0.23, 0.22, 0.19, 0.58, 0.82, 0.46, 0.64, 0.88, 0.38,
    0.43, 0.91, 0.19, 0.49, 0.44, 0.97, 0.77, 0.02, 0.2, 0.23, 0.24, 0.43, 0.56,
    0.37, 0.47, 0.52, 0.14, 0.6, 0.5, 0.57, 0.1, 0.68, 0.76, 0.96, 0.66, 0.39,
    0.39, 0.9, 0.53, 0.65, 0.51, 0.51, 0.94, 0.18, 0.41, 0.91, 0.4, 0.16, 0.98,
    0.39, 0.3, 0.64, 0.76, 0.64, 0.15, 0.79, 0.67, 0.33, 0.09, 0.2, 0.5, 0.07,
    0.13, 0.81, 0.7, 0.57, 0.05, 0.17, 0.62, 0.2, 0.55, 0.1, 0.66, 0.99, 0.95,
    0.7, 0.26, 0.67, 0.9, 0.17, 0.26, 0.13, 0.42, 0.24, 0.73, 0.21, 0.62, 0.94,
    0.12, 0.05, 0.69, 0.42, 0.64, 0.82, 0.73, 0.04, 0.7, 0.5, 0.77, 0, 0.75,
    0.46, 0.08, 0.09, 0.47, 0.44, 0.13, 0.44, 0.3, 0.02, 0.32, 0.17, 0.1, 0.16,
    0.15, 0.29, 0.73, 0.72, 0.8, 0.72, 0.19, 0.41, 0.47, 0.32, 0.61, 0.21, 0.58,
    0.81, 0.1, 0.66, 0.96, 0.92, 0.31, 0.91, 0.48, 0.32, 0.54, 0.04, 0.48, 0.28,
    0.96, 0.37, 0.88, 0.89, 0.88, 0.25, 0.84, 0.98, 0.26, 0.93, 0.67, 0.94,
    0.72, 0.47, 0.78, 0.44, 0.79, 0.42, 0.87, 0.37, 0.17, 0.62, 0.46, 0.22,
    0.99, 0.13, 0.52, 0.88, 0.01, 0.83,
  ];

  //random
  const searchVector2 = [
    0.52, 0.48, 0.96, 0.98, 0.19, 0.34, 0.39, 0.09, 0.97, 0.69, 0.61, 0.72, 0.4,
    0.22, 0.73, 0.86, 0.51, 0.3, 0.63, 0.45, 0.88, 0.63, 0.36, 0.92, 0.85, 0.93,
    0.77, 0.41, 0.62, 0.42, 0.26, 0.01, 0.13, 0.04, 0.85, 0.46, 0.59, 0.66,
    0.65, 0.73, 0.62, 0.2, 0.29, 0.68, 0.25, 0.97, 0.45, 0.86, 0.02, 0.29, 0.99,
    0.95, 0.97, 0.83, 0.24, 0.41, 0.66, 0.9, 0.28, 0.95, 0.72, 0.93, 0.3, 0.35,
    0.32, 0.25, 0.28, 0.41, 0.14, 0.45, 0.21, 0.09, 0.6, 0.15, 0.26, 0.36, 0.18,
    0.28, 0.71, 0.21, 0.33, 0.78, 0.2, 0.35, 0.51, 0.82, 0.62, 0.03, 0.99, 0.57,
    0.39, 0.56, 0.84, 0.94, 0.74, 0.12, 0.96, 0.04, 0.24, 0.58, 0.94, 0.72, 0.7,
    0.75, 0.34, 0.61, 0.68, 0.74, 0.35, 0.19, 0.61, 0.35, 0.47, 0, 0.72, 0.87,
    0.82, 0.91, 0.37, 0.95, 0.13, 0.14, 0.93, 0.38, 0.54, 0.63, 0.4, 0.46, 0.92,
    0.02, 0.05, 0.84, 0.29, 0.1, 0.77, 0.95, 0.61, 0.87, 0.74, 0.83, 0.12, 0,
    0.65, 0.76, 0.93, 0.12, 0.85, 0.64, 0.13, 0.7, 0.22, 0.3, 0.17, 0.97, 0.08,
    0.43, 0.32, 0.29, 0.09, 0.09, 0.09, 0.24, 0.83, 0.8, 0.54, 0.95, 0.81, 0.45,
    0.71, 0.78, 0.92, 0.65, 0.98, 0.29, 0.16, 0.02, 0.38, 0.95, 0.71, 0.06,
    0.31, 0.1, 0.26, 0.49, 0.32, 0.46, 0.22, 0.81, 0.07, 0.15, 0.57, 0.49, 0.13,
    0.68, 0.65, 0.72, 0.44, 0.98, 0.13, 0.68, 0.84, 0.84, 0.81, 0.85, 0.93,
    0.12, 0.38, 0.18, 0.07, 0.44, 0.95, 0.71, 0.37, 0.28, 0.4, 0.06, 0.59, 0.41,
    0.91, 1, 0.13, 0.41, 0.82, 0.96, 0.74, 0.71, 0.29, 0.93, 0.36, 0.95, 0.78,
    0.22, 0.27, 0.21, 0.39, 0.04, 0.9, 0, 0.2, 0.88, 0.11, 0.4, 0.97, 0.67,
    0.57, 0.31, 0.63, 0.71, 0.43, 0.04, 0.99, 0.97, 0.98, 0.91, 0.33, 0.7, 0.78,
    0.61, 0.51, 0.35, 0.72, 0.39, 0.77, 0.61, 0.01, 0.09, 0.24, 0.84, 0.66,
    0.38, 0.31, 0.99, 0.26, 0.91, 0.5, 0.06, 0.52, 0.39, 0.64, 0.08, 0.43, 0.12,
    0.09, 0.46, 0.45, 0.66, 0.08, 0.05, 0.07, 0.22, 0.76, 0.85, 0.42, 0.43,
    0.81, 0.31, 0.35, 0.92, 0.23, 0.24, 0.08, 0.93, 0.36, 0.41, 0.23, 0.51,
    0.06, 0.69, 0.3, 0.24, 0.23, 0.95, 0.52, 0.66, 0.52, 0.84, 0.83, 0.2, 0.62,
    0.28, 0.32, 0.37, 0.58, 0.94, 0.41, 0.83, 0.78, 0.88, 0.11, 0.62, 0.54,
    0.76, 0.49, 0.3, 0.69, 0.24, 0.38, 0.5, 1, 0.97, 0.97, 0.42, 0.05, 0.75,
    0.42, 0.19, 0.03, 0.47, 0.42, 0.49, 0.55, 0.6, 0.04, 0.43, 0.3, 0.54, 0.14,
    0.13, 0.96, 0.2, 0.78, 0.72, 0.35, 0.16, 0.66, 0.42, 0.57, 0.59, 0.11, 0.05,
    0.13, 0.85, 0.99, 0.71, 0.29, 0.9, 0.89, 0.37, 0.88, 0.89, 0.62, 0.72, 0.02,
    0.71, 0.73, 0.46, 0.37, 0.52, 0.55, 0.67, 0.5, 0.98, 0.1, 0.07, 0.28, 0.61,
    0.14, 0.66, 0.03, 0.53, 0.53, 0.96, 0.64, 0.06, 0.4, 0.75, 0.28, 0.93, 0.41,
    0.12, 0.85, 0.57, 0.74, 0.63, 0.97, 0.56, 0.42, 0.11, 0.81, 0.99, 0.73,
    0.71, 0.36, 0.97, 0.58, 0.02, 0.78, 0.91, 0.5, 0.5, 0.09, 0.2, 0.71, 0.54,
    0.45, 0.4, 0.26, 0.68, 0.75, 0.17, 0.96, 0.92, 0.05, 0.92, 0.96, 0.15, 0.93,
    0.14, 0.11, 0.17, 0.7, 0.71, 0.48, 0.02, 0.35, 0.59, 0.26, 0.17, 0.6, 0.42,
    0.45, 0.33, 0.38, 0.85, 0.64, 0.14, 0.51, 0.13, 0.07, 0.54, 0.49, 0.99,
    0.86, 0.27, 0.24, 0.18, 0.38, 0.11, 0.4, 0.04, 0.48, 0.73, 1, 0.46, 0.77, 1,
    0.34, 0.06, 0.02, 0.08, 0.22, 0.19, 0.35, 0.91, 0.96, 0.2, 0.54, 0.4, 0.36,
    0.58, 0.86, 0.17, 0.31, 0.6, 0.87, 0.48, 0.6, 0.17, 0.43, 0.1, 0.64, 0.97,
    0.72, 0.77, 0.2, 0.76, 0.19, 0.96, 0.85, 0.17, 0.97, 0.85, 0.82, 0.84, 0.48,
    0.37, 0.63, 0.47, 0.08, 0, 0.69, 0.31, 0.9, 0.5, 0.49, 0.6, 0.21, 0.43,
    0.63, 0.51, 0.64, 0.78, 0.56, 0.85, 0.46, 0.47, 0.12, 0.21, 0.4, 0.13, 0.78,
    0.37, 0.92, 0.91, 0.29, 0.9, 0.45, 0.43, 0.82, 0.11, 0.35, 0.8, 0.31, 0.7,
    0.02, 0.2, 0.15, 0.32, 0.6, 0.58, 0.79, 0.13, 0.03, 0.59, 0.83, 0.08, 0.15,
    0.83, 0.67, 0.58, 0.03, 0.62, 0.15, 0.19, 0.42, 0.75, 0.08, 0.5, 0.37, 0.68,
    0.96, 0.72, 0.19, 0.65, 0.3, 0.95, 0.02, 0.88, 0.44, 0.78, 0.9, 0.16, 0.99,
    0.24, 0.6, 0.85, 0.08, 0.24, 0.35, 0.96, 0.65, 0.79, 0.13, 0.4, 0.91, 0.06,
    0.55, 0.42, 0.93, 0.8, 0.42, 0.18, 0.16, 0.2, 0.25, 0.82, 0.55, 0.36, 0.01,
    0.41, 0.15, 0.08, 0.5, 0.95, 0.61, 0.83, 0.3, 0.09, 0.51, 0.23, 0.65, 0.46,
    0.11, 0.24, 0.51, 0.03, 0.67, 0.66, 0.56, 0.8, 0.69, 0.43, 0.33, 0.03, 0.92,
    0.97, 0.21, 0.96, 0.01, 0.58, 0.1, 0.56, 0.5, 0.21, 0.6, 0.95, 0.85, 0.2,
    0.31, 0.3, 0.73, 0.22, 0.8, 0.89, 0.08, 0.64, 0.96, 0.64, 0.52, 0.09, 0.11,
    0.39, 0.93, 0.35, 0.24, 0.62, 0.6, 0.54, 0.52, 1, 0.57, 0.35, 0.75, 0.41,
    0.24, 0.15, 0.16, 0.81, 0.29, 0.18, 0.14, 0.65, 0.76, 0.9, 0.95, 0.63, 1,
    0.91, 0.93, 0.49, 0.09, 0.35, 0.25, 0.39, 0.79, 0.46, 0.47, 0.26, 0.49,
    0.34, 0.2, 0.36, 0.98, 0.84, 0.61, 0.2, 0.71, 0.92, 0.24, 0.85, 0.94, 0.51,
    0.22, 0.41, 0.12, 0.51, 0.99, 0.56, 0.26, 0.91, 0.54, 0.79, 1, 0.44, 0.97,
    0.26, 0.81, 0.41, 0.96, 0.15, 0.54, 0.4, 0.92, 0.97, 0.86, 0.67, 0.2, 0.1,
    0.31, 0.23, 0.52, 0.51, 0.58, 0.03, 0.27, 0.36, 0.79, 0.46, 0.91, 0.66,
    0.41, 0.27, 0.84, 0.98, 0.25, 0.45, 0.26, 0.27, 0.04, 0.96, 0.2, 0.68, 0.86,
    0.6, 0.84, 0.61, 0.91, 0.69, 0.25, 0.33, 0.92, 0.64, 0.89, 0.76, 0.25, 0.91,
    0.28, 0.74, 0.45, 0.86, 0.7, 0.26, 0.65, 0.49, 0.21, 0.98, 0.86, 0.97, 0.09,
    0.02, 0.02, 0.2, 0.77, 0.56, 0.7, 0.55, 0.25, 0.16, 0.84, 0.64, 0.72, 0.24,
    0.3, 0.74, 0.35, 0.67, 0.34, 0.75, 0.96, 0.29, 0.25, 0.45, 0.07, 0.33, 0.7,
    0.37, 0.71, 0.09, 0.48, 0.66, 0.28, 0.69, 0.9, 0.77, 0.3, 0.35, 0.37, 0.96,
    0.42, 0.83, 0.81, 0.2, 0.85, 0.12, 0.63, 0.66, 0.1, 0.63, 0.05, 0.16, 0.11,
    0.25, 0.04, 0.06, 0.54, 0.55, 0.61, 0.74, 0.27, 0.06, 0.75, 0.88, 0.03,
    0.62, 0.92, 0.56, 0.57, 0.73, 0, 0.75, 0, 0.09, 0.93, 0.23, 0.15, 0.61, 0.9,
    0.75, 0.44, 0.72, 0.94, 0.75, 0.17, 0.5, 1, 0.7, 0.94, 0.61, 0.16, 0.78,
    0.81, 0.12, 0.46, 0.15, 0.44, 0.39, 0.96, 0.7, 0.29, 0.34, 0.05, 0.09, 0.84,
    0.88, 0.48, 0.25, 0.93, 0.4, 0.31, 0.61, 0.42, 0.09, 0.31, 0.9, 0.34, 0.14,
    0.87, 0.73, 0.79, 0.09, 0.07, 0.58, 0.67, 0.18, 0.58, 0.81, 0.13, 0.46,
    0.96, 0.22, 0.02, 0.59, 0.07, 0.89, 0.11, 0.51, 0.4, 0.1, 0.21, 0.51, 0.09,
    0.03, 0.25, 0.67, 0.43, 0.1, 0.94, 0.34, 0.33, 0.25, 1, 0.74, 0.95, 0.39,
    0.04, 0.03, 0.87, 0.83, 0.8, 0.48, 0.49, 0.18, 0.69, 0.85, 0.32, 0.53, 0.18,
    0.24, 0.55, 0.91, 0.91, 0.01, 0.1, 0.75, 0.38, 0.81, 0.3, 0.3, 0.24, 0.81,
    0.92, 0.23, 0.18, 0.42, 0.95, 0.64, 0.96, 0.68, 0.43, 0.55, 0, 0.43, 0.52,
    0.1, 0.87, 0.89, 0.13, 0.23, 0.09, 0.99, 0.14, 0.01, 0.81, 0.85, 0.27, 0.9,
    0.91, 0.93, 0.66, 0.72, 0.62, 0.48, 0.31, 0.68, 0.34, 0.48, 0.17, 0.69,
    0.31, 0.57, 0.93, 0.06, 0.92, 0.55, 0.82, 0.7, 0.57, 0.15, 0.66, 0.21, 0.88,
    0.76, 0.22, 0.14, 0.52, 0.85, 0.41, 0.51, 0.67, 0.56, 0.97, 0.53, 0.13,
    0.02, 0.84, 0.2, 1, 0.29, 0.96, 0.6, 0.69, 0.65, 0.69, 0.15, 0.46, 0.83,
    0.82, 0.41, 0.27, 0.27, 0.01, 0.88, 0.87, 0.05, 0.03, 0.92, 0.28, 0.5, 0.65,
    0.29, 0.41, 0.15, 0.38, 0.79, 0.21, 0.25, 0.88, 0.52, 0.62, 0.2, 0.25, 0.63,
    0.7, 0.39, 0.5, 0.94, 0.27, 0, 0.92, 0.88, 0.22, 0.17, 0.69, 0.39, 0.52,
    0.36, 0.73, 0.75, 0.87, 0.27, 0.59, 0.01, 0.36, 0.49, 0.85, 0.32, 0.33,
    0.51, 0.5, 0.89, 0.48, 0.67, 0.08, 0.19, 0.33, 0.22, 0.86, 0.4, 0.89, 0.95,
    0.75, 0.25, 0.81, 0.74, 0.85, 0.81, 0.21, 0.86, 0.52, 0.44, 0.47, 0, 0.81,
    0.75, 0.31, 0.12, 0.46, 0.39, 0.63, 0.04, 0.9, 1, 0.45, 0.9, 0.81, 0.15,
    0.62, 0.05, 0.18, 0.27, 0.74, 0.83, 0.14, 0.99, 0.08, 0.54, 0.78, 0.55,
    0.79, 0.57, 0.62, 0.11, 0.88, 0.48, 0.71, 0.61, 0.28, 0.32, 0.51, 0.98,
    0.76, 0.63, 0.83, 0.47, 0.75, 0.67, 0.56, 0.81, 0.55, 0.1, 0.87, 0.59, 0.03,
    0.28, 0.25, 0.56, 0.56, 0.26, 0.62, 0.49, 0.55, 0.52, 0.3, 0.98, 0.52, 0.45,
    0.81, 0.37, 0.05, 0.6, 0.88, 0.22, 0.27, 0.31, 0.94, 0.66, 0.03, 0.7, 0.02,
    0.49, 0.61, 0.18, 0.47, 0.86, 0.39, 0.32, 0.2, 0.28, 0.96, 0.59, 0.85, 0.51,
    0.13, 0.44, 0.43, 0.64, 0.46, 0.89, 0.7, 0.27, 0.55, 0.3, 0.88, 0.65, 0.67,
    0.48, 0.68, 0.37, 0.36, 0.52, 0.47, 0.69, 0.14, 0.15, 0.21, 0.71, 0.96,
    0.04, 0.69, 0.43, 0.86, 0.01, 0.51, 0.11, 0.55, 0.62, 0.96, 0.26, 0.74, 1,
    0.01, 0.02, 0.05, 0.09, 0.18, 0.96, 0.74, 0.64, 0.97, 0.35, 0.92, 0.33,
    0.94, 0.64, 0.26, 0.71, 0.95, 0.6, 0.24, 0.75, 0.23, 0.59, 0.77, 0.58, 0.4,
    0.58, 0.59, 0.07, 0.2, 0.05, 0.21, 0.56, 0.57, 0.03, 0.92, 0.87, 0.11, 0.58,
    0.43, 0.57, 0.41, 0.63, 0.92, 0.01, 0.05, 0.99, 0.07, 0.76, 0.36, 0.96,
    0.76, 0.31, 0.16, 0.34, 0.15, 0.9, 0.38, 0.42, 0.28, 0.91, 0.11, 0.93, 0.16,
    0.17, 0.8, 0.53, 0.02, 0.18, 0.68, 0.35, 0.72, 0.2, 0.42, 0.11, 0.94, 0.86,
    0.48, 0.78, 0.77, 0.46, 0.33, 0.62, 0.43, 0.04, 0.15, 0.81, 0.33, 0.4, 0.06,
    0.53, 0.49, 0.58, 0.8, 0.19, 0.77, 0.23, 0.88, 0.34, 0, 0.74, 0.28, 0.84,
    0.29, 0.03, 0.16, 0.57, 0.92, 0.84, 0.29, 0.44, 0.75, 0.23, 0.47, 0.34,
    0.77, 0.94, 0.31, 0.37, 0.42, 0.37, 0.09, 0.68, 0.9, 0.08, 0.25, 0.59, 0.91,
    0.6, 0.04, 0.38, 0.53, 0.53, 0.11, 0.61, 0.43, 0.8, 0.84, 0.73, 0.38, 0.21,
    0.59, 0.6, 0.68, 0.57, 0.64, 0.75, 0.95, 0.5, 0.31, 0.12, 0.37, 0.43, 0.59,
    0.07, 0.4, 0.1, 0.54, 0.06, 0.51, 0.3, 0.28, 0.19, 0.66, 0.94, 0.69, 0.13,
    0.83, 0.28, 0.62, 0.61, 0.77, 0.38, 0.98, 0.98, 0.91, 0.83, 0.26, 0.39,
    0.33, 0.06, 0.07, 0.92, 0.63, 0.12, 0.29, 0.23, 0.47, 0.33, 0.1, 0.48, 0.42,
    0.49, 0.5, 0.57, 0.99, 0.18, 0.8, 0.62, 0.9, 0.38, 0.91, 0.3, 0.66, 0.32,
    0.88, 0.28, 0.18, 0.38, 0.28, 0.62, 0.3, 0.02, 0.64, 0, 0.05, 0.84, 0.19,
    0.48, 0.92, 0.38, 0.07, 0.48, 0.57, 0.93, 0.16, 0.15, 0.05, 0.98, 0.69,
    0.22, 0.95, 0.29, 0.9, 0.69, 0.39, 0.57, 0.12, 0.27, 0.37, 0.62, 0.63, 0.13,
    0.42, 0.12, 0.37, 0.71, 0.73, 0.61, 0.21, 0.73, 0.05, 0.24, 0.23, 0.53,
    0.91, 0.45, 0.54, 0.42, 0.83, 0.62, 0.15, 0.84, 0.25, 0.93, 0.23, 0.33,
  ];

  //const listCollection = await pc.listCollections(); //returns null
  /*
const moviesGet = await pc
  .Index("sample-movies")
  .namespace("")
  .query({
    topK: 5,
    vector: searchVector,
    includeValues: true,
    filter: {
      genre: "Fantasy/Adventure",
      year: { $gt: 2020 },
    },
  });
  
  const ids = moviesGet.matches.map((match) => match.id);
    //const desc3 = await pc.Index("sample-movies").listPaginated();
*/
  /*
  await pc.Index("food").upsert([
    {
      id: "5",
      values: searchVector2,
      metadata: { Text: "comedy", User: 2020 },
    },
    {
      id: "6",
      values: searchVector2,
      metadata: { Text: "documentary", User: 2019 },
    },
    {
      id: "7",
      values: searchVector2,
      metadata: { Text: "comedy", User: 2019 },
    },
    {
      id: "8",
      values: searchVector2,
      metadata: { Text: "drama" },
    },
  ]);
*/

  const result = await parseCSVandUpsert(filePath);
  const check = searchVector.length;
  //console.log(check);  JSON.parse(item.values || "[]")

  return NextResponse.json(check, { status: 201 });
  //return NextResponse.json(ids, { status: 201 });
}

const parseCSVandUpsert = async (filePath: string) => {
  const results: any[] = [];

  const searchVector = [
    0.03685142, -0.042842165, -0.021373346, 0.006933509, -0.00895628,
    -0.00070110784, -0.03847441, 0.061625887, 0.0069036745, -0.010817945,
    0.016182166, -0.0420068, 0.017112998, 0.0037054296, -0.004463223,
    0.010627005, -0.0154900085, -0.02253092, -0.036994625, 0.004317034,
    0.015072327, 0.030812943, -0.039262038, -0.03467948, 0.01995323,
    -0.009099484, 0.006217484, -0.028521664, 0.047830474, -0.04078956,
    -0.003962005, -0.012244028, -0.029357025, -0.056804653, 0.000054261272,
    0.022733795, -0.021743294, 0.013043589, 0.021015335, 0.011277394,
    0.026898673, 0.017518746, 0.016671449, 0.0035144896, 0.009582802,
    0.025227949, 0.00505096, 0.002488187, -0.03611153, -0.0104658995,
    -0.02503701, 0.070170455, -0.05398829, 0.0070170453, 0.040169004,
    -0.0070289792, -0.03704236, 0.014380169, -0.010125787, 0.0031952618,
    -0.015179731, -0.04269896, 0.04849876, 0.020537985, 0.01957135,
    -0.043582056, -0.04740086, -0.021337546, 0.03277008, -0.035944458,
    0.031027751, -0.023342416, -0.022865066, 0.0257769, 0.0429615, 0.018019963,
    0.050885513, 0.014511441, 0.05174474, -0.012005353, -0.04709058,
    0.022805396, -0.008466996, -0.025275683, 0.03618313, -0.052699443,
    0.009660371, -0.008240255, 0.049214788, -0.019129802, 0.018342175,
    -0.029810509, -0.025562095, 0.012351432, -0.014034091, 0.00446919,
    -0.04556306, 0.022184841, 0.005453724, -0.054656576, -0.017685818,
    0.0071483166, -0.02396297, -0.020454448, 0.015788352, -0.02923769,
    0.031361897, -0.033271298, 0.0033712846, -0.0044960403, -0.01915367,
    -0.0030386313, -0.037304904, 0.009206888, 0.0075898655, 0.006790304,
    -0.0057282, 0.0315051, -0.035300035, 0.015370671, -0.024130043,
    -0.016611781, -0.022960536, -0.0126259085, -0.049167052, -0.016337305,
    -0.0043200175, -0.024869936, 0.056470506, -0.049501196, 0.020251574,
    0.002646309, 0.0033921686, -0.010794077, -0.076280534, 0.005358254,
    -0.015645146, -0.011557837, 0.0031863113, 0.02278153, 0.03315196,
    -0.050933246, -0.0052120658, -0.0017318856, -0.025633696, -0.010394297,
    -0.07040913, 0.0010964134, -0.0097379405, 0.008866777, -0.035085227,
    0.0023405068, 0.0057431175, -0.010585236, 0.0023061973, 0.007929977,
    0.036087662, -0.008407327, -0.031839248, 0.017268136, -0.0007096852,
    0.04126691, -0.015931558, 0.04413101, -0.029762775, -0.017268136,
    -0.015788352, 0.017840957, -0.026445191, 0.0054626744, 0.02637359,
    -0.020442514, 0.007888209, -0.037639048, -0.014547242, -0.028688736,
    -0.011002918, -0.039381377, 0.0025031043, -0.017852891, 0.0018422727,
    0.05007402, -0.025275683, -0.018688254, -0.06415584, 0.018938862,
    -0.053224526, -0.010734408, 0.0008786224, 0.030192388, 0.008228321,
    -0.01728007, 0.028306857, -0.030335594, -0.0026746518, -0.0044930573,
    0.013628343, 0.025848504, 0.017578414, 0.0544179, 0.0050091916, 0.034703348,
    0.029738907, -0.020657321, 0.012411101, -0.06253285, -0.043605924,
    0.03410666, 0.016182166, -0.040359944, 0.033486106, -0.03432147,
    -0.026087178, 0.015597412, -0.02771017, 0.0021182408, -0.041052103,
    0.024702864, 0.05580222, 0.034894288, 0.009493299, 0.004436372, 0.056375038,
    -0.017160734, -0.0065874304, -0.027853373, 0.030025316, -0.059859693,
    -0.010752309, 0.008341691, 0.020263508, 0.0055730613, 0.016206034,
    0.0409805, -0.014523375, 0.036994625, 0.021934234, -0.024225514,
    0.009594736, -0.056756917, -0.014439838, -0.016015094, 0.0012560273,
    0.019452013, -0.0030968082, 0.0023673577, -0.011337063, -0.025920106,
    -0.012876517, 0.034035057, -0.02978664, 0.008980148, 0.04095663,
    -0.019833893, 0.0045586927, 0.013473204, -0.021993902, -0.0018407811,
    -0.008836943, -0.0063368217, 0.0039978065, 0.013318066, -0.0085744,
    0.03076521, -0.023807833, -0.016635649, 0.020514118, 0.03112322,
    -0.028617134, 0.030168522, -0.0010404739, 0.0046392456, -0.00015560492,
    -0.03494202, -0.015800286, -0.041601054, 0.001235889, 0.021588154,
    0.0014410004, 0.04277056, -0.018903062, 0.007273621, 0.0038456512,
    -0.0685952, 0.027304422, 0.00083834596, 0.013497072, -0.03417826,
    -0.006414391, -0.009218822, -0.03181538, -0.034154393, 0.044990238,
    0.020287376, 0.029762775, 0.031457365, -0.060193837, 0.008902578,
    0.017065262, -0.013592542, 0.017793221, 0.018735988, 0.0054686414,
    -0.0058117365, -0.045300517, 0.005713283, 0.044107143, 0.029929847,
    0.011229659, 0.051458333, 0.040336076, 0.03971552, 0.041243043,
    -0.018019963, 0.0023226063, -0.0400258, 0.026612263, -0.0051643304,
    -0.02297247, -0.07881049, 0.0052956017, 0.0021973017, 0.014547242,
    0.02049025, -0.007118482, -0.039620053, 0.031266425, -0.036946893,
    0.021397214, 0.03274621, -0.009666338, 0.047687266, -0.0352523, 0.019046266,
    -0.07709203, -0.03219726, -0.044656094, -0.054608844, -0.02344982,
    0.02720895, -0.036565013, -0.021361414, -0.028282989, -0.023748163,
    0.008395393, 0.02300827, 0.04830782, 0.027161216, -0.0060504116,
    0.045109577, 0.0015812219, 0.0029103435, -0.011826347, -0.006217484,
    -0.015609345, 0.04117144, 0.016206034, -0.03718557, -0.03754358, 0.0190582,
    -0.023425952, 0.06701994, -0.018067699, 0.014451772, 0.017590348,
    -0.017506812, 0.019714557, -0.014869453, -0.011599606, 0.023581091,
    0.04792594, 0.054322433, 0.020084502, 0.037113965, -0.017268136,
    0.019941296, 0.06921575, 0.023628825, -0.004445322, 0.033677045,
    0.017232336, 0.048164617, 0.03121869, 0.008777274, -0.0032101788,
    -0.024798334, -0.011426566, 0.03983486, 0.019141736, 0.0064800265,
    0.016850457, -0.017327806, -0.04279443, 0.027543096, -0.011784579,
    -0.016420841, 0.0007104311, 0.029715039, -0.04988308, -0.03580125,
    -0.011712976, -0.0025672482, -0.062341914, 0.012190326, 0.027924975,
    0.013867018, -0.006659033, 0.007225886, 0.018855326, -0.005092728,
    -0.0014506965, 0.028855808, 0.031552836, -0.003947088, 0.011742811,
    0.0119158495, -0.0001411539, 0.039285906, -0.01708913, -0.019452013,
    -0.041577186, -0.053224526, -0.046947375, 0.026230384, -0.045324385,
    -0.02513248, -0.011880049, -0.006617265, -0.04317631, -0.05704333,
    -0.050503634, 0.02845006, 0.0059698587, -0.038235735, 0.0073929583,
    -0.08745053, -0.042293213, -0.028187519, 0.009290425, -0.018449578,
    -0.019416213, -0.019487815, -0.0038665351, -0.001331359, -0.02587237,
    0.009905013, -0.0034936054, 0.057568412, -0.002274871, -0.02370043,
    0.025442757, -0.039262038, -0.04709058, 0.033748645, -0.014654646,
    0.040336076, -0.0057162666, -0.049835343, 0.006790304, 0.03255527,
    0.042746693, -0.004594494, -0.006402457, -0.028115917, -0.013890886,
    0.020000966, 0.046279084, 0.02720895, -0.006545662, -0.016122498,
    0.031791512, -0.043916203, -0.019583285, 0.00063099706, -0.00876534,
    -0.03331903, 0.0070289792, 0.02087213, -0.008317824, -0.021146607,
    0.0013395635, 0.017864825, 0.011020819, 0.023020204, 0.01644471,
    -0.03133803, -0.0076197, -0.008550532, -0.054656576, 0.0126259085,
    -0.03677982, -0.00024277724, -0.033724777, -0.010030317, 0.010179489,
    0.029953714, -0.0034578042, 0.016325371, 0.023223078, 0.021552354,
    0.0055253264, -0.00271642, 0.019631019, 0.050455898, -0.012387233,
    0.037209433, -0.035490975, 0.0083058905, 0.0007898651, 0.057186533,
    -0.0800516, 0.017638084, 0.0018452562, 0.03773452, -0.026874807,
    -0.029022882, -0.0133299995, -0.019189471, -0.03601606, -0.0026552596,
    -0.013091324, 0.0007208731, 0.03885629, -0.050599102, 0.012769113,
    0.028855808, -0.04152945, 0.020537985, -0.022483187, 0.027877241,
    -0.02854553, -0.028593266, 0.0052299662, 0.043772995, -0.028688736,
    -0.027280554, 0.025920106, 0.024488056, -0.0171846, 0.036063794,
    0.014380169, 0.018401843, -0.019929362, -0.023223078, 0.026588397,
    -0.04028834, -0.0010158605, -0.019989032, 0.0064800265, 0.014523375,
    -0.022602523, -0.020752791, -0.0055104094, 0.027161216, 0.043367248,
    0.0035055391, -0.007410859, -0.033223562, 0.048976112, 0.012530438,
    -0.027781771, -0.0210034, 0.007184118, 0.048355557, 0.0025478557,
    0.02484607, 0.024130043, -0.040527016, -0.033581574, 0.026540661,
    0.008389426, 0.036827553, 0.002058572, -0.048093013, 0.044489022,
    0.007840474, 0.011593639, -0.00028715588, 0.025753034, 0.046828035,
    -0.026134914, -0.0619123, -0.039023366, 0.034655612, -0.024297116,
    0.010000483, -0.015275201, -0.0008629593, 0.007595832, 0.035204563,
    -0.024392586, 0.033867985, 0.025371153, 0.011826347, -0.020311244,
    -0.0011836789, -0.008377492, 0.016874323, -0.013186795, 0.003926204,
    -0.015919624, 0.01743521, -0.0036159265, -0.0074705277, -0.045539193,
    0.013783482, -0.018998532, 0.011772645, 0.0065217945, -0.013604475,
    0.020860195, -0.012900384, 0.0077390373, -0.040264476, 0.008532631,
    -0.0044184714, -0.0022644291, -0.01609863, 0.022483187, -0.01078811,
    -0.03487042, -0.00024408249, 0.018306373, -0.018545048, 0.00022189318,
    0.0118919825, 0.024416454, -0.017017528, -0.030431064, -0.04661323,
    -0.00876534, 0.007941911, 0.025180213, -0.026230384, -0.021277877,
    -0.016528245, -0.00656953, -0.017685818, 0.009970648, 0.055706747,
    0.0041827797, 0.034894288, 0.004642229, -0.01680272, -0.038020927,
    0.02568143, 0.019094002, -0.004472173, 0.009039816, 0.0033533839,
    0.032030188, -0.016217967, 0.022244511, 0.027757904, 0.020657321,
    0.025991708, -0.028975146, -0.066447124, -0.012351432, -0.0065754964,
    -0.03503749, 0.02230418, -0.00073616323, 0.032101788, 0.02780564,
    0.00801948, 0.0058057695, -0.0056028957, 0.01838991, -0.00916512,
    0.039596185, 0.0075361636, 0.043796863, -0.023390152, -0.020669255,
    -0.053558674, 0.00446919, 0.0024762533, 0.024607394, 0.007947878,
    0.0035353736, -0.005874389, -0.015060393, -0.037519712, 0.0031206757,
    -0.030645872, 0.008950313, -0.00828799, 0.024583526, 0.018222837,
    -0.005746101, -0.002461336, 0.01556161, -0.030383328, 0.028641, -0.02167169,
    0.006891741, -0.029213822, -0.016540179, -0.02278153, 0.0200487,
    0.0026015576, 0.0043051005, -0.0082700895, -0.038951762, 0.024869936,
    -0.04718605, -0.02539502, -0.0104599325, -0.020024834, -0.014642712,
    -0.0076853354, -0.008675837, 0.02430905, 0.017315872, -0.038927894,
    -0.004206647, -0.04451289, 0.012709444, -0.01976229, -0.008276056,
    0.025562095, -0.000806274, -0.00019224526, 0.0018079632, 0.03458401,
    0.055754483, -0.012864583, -0.025275683, 0.017005594, -0.034798816,
    -0.00065076235, 0.013246463, 0.002461336, -0.037090097, -0.018163169,
    -0.0076793684, -0.0032221125, -0.02023964, -0.023246946, -0.006945443,
    -0.044107143, 0.008240255, 0.021755228, 0.01638504, -0.017984161,
    0.02835459, -0.041243043, -0.0051434464, -0.01390282, -0.047711134,
    0.008168653, 0.01037043, 0.02230418, -0.011259493, -0.046255216,
    0.034273732, -0.052508503, -0.009451531, 0.016027028, -0.0040127235,
    -0.017697752, -0.0323882, 0.0037710653, -0.015024592, -0.015215532,
    -0.009141253, -0.0097618075, 0.0058505214, -0.00135821, -0.029547967,
    0.041386247, -0.005459691, 0.037782256, 0.01153397, -0.045539193,
    -0.0005765493, 0.010340595, -0.016313437, 0.02424938, 0.0023315565,
    -0.005140463, -0.020907931, -0.020418648, -0.005931074, -0.03828347,
    0.013747681, -0.05298585, -0.048785172, 0.014583043, -0.02430905,
    0.009415729, 0.010913415, -0.0019884612, -0.023425952, -0.021492684,
    0.012506571, -0.041601054, -0.068547465, 0.032650743, -0.021397214,
    -0.018222837, -0.017709685, 0.014332434, 0.025084743, -0.04129078,
    0.011235626, 0.032221127, -0.06472866, -0.0052478667, 0.02692254,
    0.028951278, 0.0071363826, -0.017602282, -0.017769355, 0.042078406,
    0.002552331, -0.000939037, 0.013067457, -0.0071363826, -0.0029789624,
    0.040145136, 0.013258397, -0.021051137, 0.02134948, -0.020526052,
    -0.038736954, 0.023366284, 0.012983921, 0.020573786, -0.029738907,
    -0.002631392, 0.006265219, 0.018366043, 0.008359592, 0.0043468685,
    -0.0046123946, 0.008144785, 0.0019780193, -0.0077390373, 0.020000966,
    -0.036994625, -0.018127367, -0.0043468685, -0.030311726, -0.0074287597,
    -0.03305649, 0.053797346, -0.018664386, 0.01399829, 0.013019722,
    0.0018646485, -0.0058505214, 0.0012724361, -0.012542372, -0.03742424,
    0.032125656, -0.043701395, -0.020323178, -0.04362979, -0.018891128,
    0.029715039, 0.0028089066, 0.021158539, -0.0034727214, -0.016313437,
    -0.010871647, 0.020251574, 0.020943733, 0.0008368543, 0.0119098835,
    0.010048218, -0.027686302, -0.005206099, 0.0314335, 0.022614457,
    0.009206888, -0.0032280795, -0.006169749, 0.019296875, 0.012076955,
    0.017136866, -0.039763257, 0.021552354, 0.034918156, -0.008920479,
    0.0013097291, 0.04164879, 0.019046266, 0.0052389163, 0.013174861,
    -0.028378459, 0.0016662499, 0.0076853354, -0.028999014, 0.027304422,
    0.0030908415, 0.016110564, 0.0074168257, -0.014952989, -0.0006429308,
    0.054942988, -0.02074086, -0.020215774, -0.019583285, 0.0022838216,
    0.011492202, -0.01976229, 0.016337305, 0.018031897, 0.04148172,
    -0.051792476, -0.0141176265, 0.025753034, -0.059239138, -0.00876534,
    -0.022447385, -0.013878952, -0.010358496, -0.009004015, 0.028521664,
    -0.015871888, -0.0024404519, 0.032984886, -0.022363849, 0.025609829,
    0.018270573, 0.017984161, 0.07699656, 0.012769113, -0.003565208, 0.00446919,
    0.0304788, 0.025753034, 0.025609829, 0.033963453, 0.04172039, 0.016599847,
    0.01689819, 0.035204563, 0.0012642317, 0.031910848, -0.022614457,
    0.00571925, 0.0060862126, 0.00020361962, 0.00551936, 0.006163782,
    0.012852649, 0.013043589, 0.042627357, -0.01924914, 0.024798334,
    0.023175344, -0.039214306, -0.031791512, -0.022614457, 0.0038814524,
    0.023187278, -0.033748645, 0.045348253, 0.009505232, -0.016265702,
    -0.0059042233, -0.029166086, 0.0026343754, 0.014845585, 0.0024464189,
    -0.00533737, 0.0040395744, -0.031003883, -0.023437886, 0.0053135026,
    -0.051267393, 0.013580608, -0.011348996, -0.010000483, 0.02513248,
    0.015203598, 0.021612022, -0.018747922, 0.0362786, -0.0015498959,
    0.03066974, -0.029476363, 0.060909864, -0.00210034, -0.034464672,
    -0.00906965, -0.004540792, 0.015203598, 0.021015335, 0.001522299,
    0.0083297575, -0.0018795657, 0.006074279, -0.0018392893, -0.014547242,
    0.001543929, 0.024165845, -0.0009882638, 0.00006488977, 0.02430905,
    0.029404761, 0.0013887902, 0.021755228, 0.07418019, -0.023211144,
    -0.009922913, -0.036254734, -0.019177537, -0.015967358, 0.015931558,
    0.0060563786, 0.014236964, -0.0042305146, -0.0060981466, -0.028497797,
    -0.023211144, 0.035300035, 0.019798093, 0.006509861, 0.02128981,
    0.056995593, 0.009457497, -0.0055581443, 0.0053701876, 0.0060981466,
    0.020705057, 0.00036547112, -0.033772513, -0.008079149, 0.016074762,
    0.0140818255, -0.0097021395, -0.009272524, -0.027280554, 0.012160492,
    0.022960536, -0.0029222772, -0.028402327, -0.027185084, -0.049453463,
    -0.0070289792, -0.019475881, -0.010149655, -0.008950313, -0.02627812,
    0.039190438, -0.012094856, 0.013150993, -0.03257914, 0.039620053,
    -0.008813075, 0.037495844, 0.027328288, 0.015991226, -0.0076972693,
    0.017852891, 0.037304904, -0.05651824, -0.016015094, -0.014618845,
    0.000010663459, 0.007381025, -0.003278798, 0.005131513, -0.04458449,
    0.010036284, 0.03200632, 0.008425228, 0.047162183, 0.016635649, 0.017840957,
    -0.031266425, 0.031910848, -0.02360496, -0.033867985, 0.015048459,
    -0.0039321706, 0.040861163, 0.013699946, -0.034822684, -0.016910125,
    -0.023342416, -0.012088889, 0.02513248, -0.034989756, -0.031576704,
    0.022149041, 0.006838039, -0.010274959, 0.0061578155, 0.010895514,
    -0.014201163, -0.01747101, 0.02835459, 0.02182683, 0.0071005817,
    0.009654405, 0.030287858, -0.029762775, 0.004603444, 0.0054089725,
    0.0066291983, 0.034607876, 0.04649389, 0.018831458, -0.019881628,
    0.016945926, 0.016719185, 0.017136866, -0.0005672261, 0.02262639,
    -0.014213097, 0.018592784, 0.005486542, 0.020848263, -0.010358496,
    0.011020819, -0.052699443, 0.0020555886, -0.027399892, -0.004776484,
    0.013425469, 0.033175826, 0.02058572, 0.012178392, 0.0052866517,
    -0.023807833, 0.002710453, 0.031147089, 0.0013977406, -0.05527713,
    0.019082068, 0.015120062, -0.01924914, 0.007667435, 0.013091324, 0.02220871,
    0.020860195, 0.007452627, -0.01657598, 0.0031624439, 0.06119627,
    -0.02969117, 0.014964923, 0.081006296, 0.008830976, 0.013401601,
    -0.029547967, -0.011963584, 0.00446919, -0.021182407, -0.016277635,
    0.021158539, -0.0076376004, -0.021492684, 0.008556499, -0.008777274,
    0.026111046, 0.036803685, 0.0058863224, -0.0040783593, -0.010579269,
    0.021337546, -0.008180586, -0.008902578, -0.020561852, 0.008120917,
    -0.025609829, 0.017411342, 0.008580367, -0.019595219, -0.0038008995,
    -0.014499507, 0.032626875, 0.005868422, 0.0104718665, 0.008777274,
    0.008216388, -0.0030759242, -0.04432195, -0.02201777, -0.02549049,
    0.0062532853, -0.013437403, 0.017124932, -0.0017676868, -0.0017154766,
    0.007178151, 0.011951651, 0.024989273, 0.028044313, 0.0141176265,
    -0.01995323, -0.017864825, 0.009397829, -0.011289328, 0.016838523,
    0.0019526599, 0.047544062, 0.01172491, 0.01737554, -0.0143205, 0.02790111,
    0.005474608, -0.012267896, -0.004108194, 0.0034876387, -0.0040306244,
    -0.0104658995, -0.008144785, 0.020991467, -0.013699946, 0.0035353736,
    0.011539937, 0.01787676, 0.021588154, 0.014177295, -0.025633696,
    0.00019709335, 0.005185215, 0.014726249, -0.0062115174, -0.015979292,
    -0.049835343, -0.055038456, 0.019738423, 0.010155622, 0.00071639795,
    0.013843151, 0.038569883, -0.032221127, 0.02494154, -0.0018392893,
    -0.005874389, -0.015597412, -0.0071363826, 0.042317078, 0.028139783,
    -0.009373961, 0.011104355, 0.0021048153, -0.014917188, -0.033366766,
    -0.024165845, 0.005185215, 0.014415971, -0.012291763, 0.01019739,
    -0.0059668752, -0.024070375, 0.005131513, -0.021146607, -0.020931799,
    -0.0049077547, -0.017900625, -0.011414632, -0.015096194, 0.02646906,
    -0.009690206, 0.033891853, -0.060527984, 0.020430582, -0.0045020073,
    -0.0042513986, 0.009684239, 0.014248898, 0.0005049468, 0.06826105,
    0.0046332786, 0.03809253, 0.0052239993, 0.06310567, -0.04076569,
    0.021910366, -0.018640518, -0.010913415, 0.009714073, -0.0035144896,
    -0.0013492596, -0.0061578155, 0.0015230449, -0.010621038, 0.021958102,
    -0.0061876494, 0.00036640343, 0.000265153, -0.01708913, 0.021588154,
    0.032603007, -0.021958102, -0.0073869918, 0.0060921796, -0.0058594714,
    0.015967358, 0.014917188, 0.017005594, -0.007912077, -0.000027596798,
    0.007130416, -0.00037125152, -0.024082309, -0.029619569, 0.0021331578,
    -0.038259603, -0.007172184, -0.0119039165, 0.030741341, 0.018974664,
    0.0024762533, 0.0023584075, -0.032793947, -0.0067724036, 0.0027924976,
    -0.0114564, -0.0077330703, 0.03420213, 0.029022882, 0.032412067,
    -0.010143688, -0.0010762751, -0.027256686, 0.04775887, 0.021862632,
    0.0021033236, 0.009230756, -0.0016468576, -0.008830976, 0.044990238,
    0.015227466, 0.015406472, 0.028975146, -0.013532873, 0.0009576835,
    -0.02780564, 0.0021077986, -0.005065877, 0.013473204, -0.010251092,
    0.021301745, 0.010835845, 0.00003137271, 0.02138528, -0.005671515,
    -0.0059191403, -0.04460836, 0.0057222336, -0.01575255, 0.054131493,
    0.020800527, 0.028736472, 0.0342976, -0.006122014, 0.057711616, 0.003416036,
    0.019547483, 0.0072497535, -0.011158057, 0.013377734, 0.06315341,
    0.007231853, -0.032841682, -0.004006757, -0.029762775, 0.0033533839,
    0.019273007, -0.028927412, 0.006688867, -0.0018706154, -0.0069693103,
    -0.005802786, 0.040908895, 0.00040723925, 0.03200632, 0.01708913,
    0.012673643, -0.025967842, 0.017005594, -0.017315872, -0.024130043,
    0.010841812, 0.02230418, -0.023939103, 0.037328772, 0.011295295,
    -0.036612745, 0.0048093013, 0.028306857, -0.019810027, -0.004185763,
    0.0015111112, -0.009499266, -0.0026179666, -0.024965405, -0.02316341,
    -0.012458836, -0.010650872, 0.027137348, -0.012387233, -0.0065277615,
    -0.014499507, -0.025800768, 0.0010814961, -0.017029462, -0.03506136,
    -0.037662916, -0.02300827, 0.01638504, -0.0013276298, -0.0140937595,
    0.0028476913, 0.015919624, -0.013735747, -0.02039478, 0.018115433,
    -0.037853856, -0.0050479765, 0.02835459, -0.011032753, -0.024511924,
    0.02300827, -0.029189954, 0.0038188002, -0.027972711, -0.009379928,
    -0.00828799, -0.011844248, -0.021958102, 0.007780805, -0.032817814,
    0.03866535, -0.00006969124, 0.030693606, -0.02316341, 0.025943974,
    -0.008872744, 0.011229659, 0.012375299, 0.0025448722, 0.0073631243,
    0.05508619, 0.017351674, 0.020597653, -0.030216256, 0.038927894, 0.0021436,
    0.023294682, -0.0066470993, 0.0021122738, 0.024869936, 0.04506184,
    0.02259059, 0.047615666, -0.047496326, 0.027638566, -0.020382846,
    0.02402264, 0.006515828, 0.0041976967, 0.010543468, -0.037281036,
    -0.0045855436, 0.0038784689, 0.03983486, 0.0033921686, -0.01747101,
    0.010549435, -0.020418648, -0.018366043, -0.010591203, 0.020943733,
    -0.0050688605, 0.0034369202, -0.036206998, -0.014010224, 0.020072568,
    -0.023079874, 0.048928376, 0.057568412, -0.0063726227, 0.014344368,
    -0.004839136, 0.017566482, 0.007959812, -0.0016945925, -0.019428145,
    0.007780805, 0.049835343, -0.004248415, -0.005534277, 0.026612263,
    0.008031414, 0.024368718, -0.012190326, 0.03990646, -0.028927412,
    0.036708217, 0.025705298, -0.032817814, 0.0013671604, -0.031791512,
    0.0036308437, -0.068690665, 0.023139542, -0.02440452, -0.021910366,
    0.035109095, 0.015859954, 0.019189471, -0.012315631, 0.036206998,
    -0.01256624, -0.00082193705, 0.013401601, 0.012100823, -0.021122739,
    0.056947857, -0.011623473, -0.0022927718, 0.014034091, 0.026445191,
    -0.03668435, 0.019463947, -0.0037024461, -0.006796271, 0.013389668,
    0.013091324, 0.010609104, -0.011516069, 0.062819265, -0.016922059,
    0.020848263, -0.01269751, -0.02217291,
  ];

  fs.createReadStream(filePath)
    .pipe(csv())
    .on("data", (data) => results.push(data))
    .on("end", async () => {
      // Validate and prepare data for Pinecone upsert
      const formattedData = results.map((item) => {
        //console.log(item.values);

        if (!item.values) {
          throw new Error("Values field is missing or empty");
        }
        return {
          id: item.User,
          values: searchVector, // Safely parse the values or default to empty array
          metadata: {
            Text: item.Text,
            User: parseInt(item.User || "0"),
          }, // Provide default values if missing
        };
      });

      // Perform the upsert operation
      await pc.Index("food").upsert(formattedData);
      console.log("Upsert completed successfully");
    });
};
